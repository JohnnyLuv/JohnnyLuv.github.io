---
title: remè‡ªé€‚åº”æ–¹æ¡ˆâ€”â€”flexibleJS
date: 2019-06-27 10:08:15
categories: JavaScript
tags: [rem, css, JavaScript]
---

markä¸€ä¸‹remè‡ªé€‚åº”æ–¹æ¡ˆ
ğŸŒˆ[amfe/lib-flexible](https://github.com/amfe/lib-flexible)
ğŸŒˆ[Remè‡ªé€‚åº”jsä¹‹ç²¾ç®€ç‰ˆflexible.js](http://caibaojian.com/simple-flexible.html)
<!-- more -->

```js
// designWidth:è®¾è®¡ç¨¿çš„å®é™…å®½åº¦å€¼ï¼Œéœ€è¦æ ¹æ®å®é™…è®¾ç½®
// maxWidth:åˆ¶ä½œç¨¿çš„æœ€å¤§å®½åº¦å€¼ï¼Œéœ€è¦æ ¹æ®å®é™…è®¾ç½®
// è¿™æ®µjsçš„æœ€åé¢æœ‰ä¸¤ä¸ªå‚æ•°è®°å¾—è¦è®¾ç½®ï¼Œä¸€ä¸ªä¸ºè®¾è®¡ç¨¿å®é™…å®½åº¦ï¼Œä¸€ä¸ªä¸ºåˆ¶ä½œç¨¿æœ€å¤§å®½åº¦ï¼Œä¾‹å¦‚è®¾è®¡ç¨¿ä¸º750ï¼Œæœ€å¤§å®½åº¦ä¸º750ï¼Œåˆ™ä¸º(750,750)

;(function(designWidth, maxWidth) {
	var doc = document,
	win = window,
	docEl = doc.documentElement,
	remStyle = document.createElement("style"),
	tid;

	function refreshRem() {
		var width = docEl.getBoundingClientRect().width;
		maxWidth = maxWidth || 540;
		width>maxWidth && (width=maxWidth);
		var rem = width * 100 / designWidth;
		remStyle.innerHTML = 'html{font-size:' + rem + 'px;}';
	}

	if (docEl.firstElementChild) {
		docEl.firstElementChild.appendChild(remStyle);
	} else {
		var wrap = doc.createElement("div");
		wrap.appendChild(remStyle);
		doc.write(wrap.innerHTML);
		wrap = null;
	}
	//è¦ç­‰ wiewport è®¾ç½®å¥½åæ‰èƒ½æ‰§è¡Œ refreshRemï¼Œä¸ç„¶ refreshRem ä¼šæ‰§è¡Œ2æ¬¡ï¼›
	refreshRem();

	win.addEventListener("resize", function() {
		clearTimeout(tid); //é˜²æ­¢æ‰§è¡Œä¸¤æ¬¡
		tid = setTimeout(refreshRem, 300);
	}, false);

	win.addEventListener("pageshow", function(e) {
		if (e.persisted) { // æµè§ˆå™¨åé€€çš„æ—¶å€™é‡æ–°è®¡ç®—
			clearTimeout(tid);
			tid = setTimeout(refreshRem, 300);
		}
	}, false);

	if (doc.readyState === "complete") {
		doc.body.style.fontSize = "16px";
	} else {
		doc.addEventListener("DOMContentLoaded", function(e) {
			doc.body.style.fontSize = "16px";
		}, false);
	}
})(750, 750);
```